!function(a){"use strict";function d(a,b){var c="െേൈൊോൌெேைொோௌେୈୋୌિਿिিেৈোৌෙේෛොෝෞ";return c.indexOf(b[a.length])<=0}var b,c;b=function(b,c){this.$element=a(b),this.options=a.extend({},a.fn.regionselector.defaults,c),this.$element.addClass("languagefilter"),this.resultCount=0,this.$suggestion=this.$element.parents().find("#"+this.$element.data("suggestion")),this.$clear=this.$element.parents().find("#"+this.$element.data("clear")),this.selectedLanguage=null,this.listen()},c=function(){var a=0;return function(b,c){clearTimeout(a),a=setTimeout(b,c)}}(),b.prototype={listen:function(){this.$element.on("keypress",a.proxy(this.keyup,this)).on("keyup",a.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",a.proxy(this.keyup,this)),this.$clear.length&&this.$clear.on("click",a.proxy(this.clear,this)),this.toggleClear()},keyup:function(b){var d,e,f;switch(b.keyCode){case 9:d=this.$suggestion.val(),d&&d!==this.$element.val()&&(this.$element.val(d),b.preventDefault(),b.stopPropagation());break;case 13:if(!this.options.onSelect)break;b.preventDefault(),b.stopPropagation(),e=a.trim(this.$element.val()).toLowerCase(),this.selectedLanguage?this.options.onSelect(this.selectedLanguage):this.options.languages[e]&&this.options.onSelect(e);break;default:if(f=this,b.which<32&&8!==b.which)break;this.selectedLanguage=null,c(function(){f.$element.val()?(f.options.$target.empty(),f.search()):f.clear()},300),this.toggleClear()}},deactivate:function(){this.$element.val(""),a.fn.uls.Constructor.prototype.isMobile()||this.$element.focus(),this.toggleClear(),this.autofill()},clear:function(){this.deactivate(),this.$element.trigger("searchclear")},toggleClear:function(){this.$clear.length&&(this.$element.val()?this.$clear.show():this.$clear.hide())},search:function(){var b,e,f,g,c=a.trim(this.$element.val()),d=a.uls.data.getLanguagesByScriptGroup(this.options.languages);this.resultCount=0;for(e in d)for(b=d[e],b.sort(a.uls.data.sortByAutonym),f=0;f<b.length;f++)g=b[f],(""===c||this.filter(g,c))&&(0===this.resultCount&&this.autofill(g),c.toLowerCase()===g&&(this.selectedLanguage=g),this.render(g),this.resultCount++);!this.resultCount&&this.options.searchAPI&&c?this.searchAPI(c):this.resultHandler(c)},searchAPI:function(b){var c=this;a.get(c.options.searchAPI,{search:b},function(d){a.each(d.languagesearch,function(a,b){0===c.resultCount&&c.autofill(a,b),c.render(a),c.resultCount++}),c.resultHandler(b)})},resultHandler:function(a){0===this.resultCount&&this.options.noresults?(this.$suggestion.val(""),this.options.noresults.call(this,a)):this.options.success&&this.options.success(this,a,this.resultCount)},autofill:function(b,c){if(this.$suggestion.length){if(!this.$element.val())return void this.$suggestion.val("");if(this.selectedLanguage=b,c=c||this.options.languages[b]){var e,f=this.$element.val(),g=f+c.substring(f.length,c.length);g.toLowerCase()!==c.toLowerCase()&&(e=a.uls.data.getAutonym(b)||"",g=f+e.substring(f.length,e.length),g!==e&&(g="")),d(f,g)||(g=""),this.$suggestion.val(g)}}},render:function(a){var b=this.options.$target;b&&b.append(a,null)},escapeRegex:function(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$\|#\s]/g,"\\$&")},filter:function(b,c){var d=new RegExp("^"+this.escapeRegex(c),"i"),e=this.options.languages[b];return d.test(e)||d.test(a.uls.data.getAutonym(b))||d.test(b)||d.test(a.uls.data.getScript(b))},eventSupported:function(a){var b=a in this.$element;return b||(this.$element.setAttribute(a,"return;"),b="function"==typeof this.$element[a]),b}},a.fn.languagefilter=function(c){return this.each(function(){var d=a(this),e=d.data("languagefilter"),f="object"==typeof c&&c;e||d.data("languagefilter",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.languagefilter.defaults={$target:null,searchAPI:null,languages:null,noresults:null,success:null,onSelect:null},a.fn.languagefilter.Constructor=b}(jQuery);